<!--
  ~ This file is part of NxFIFTEEN Fitness Core.
  ~
  ~ @link      https://nxfifteen.me.uk/projects/nxcore/
  ~ @link      https://gitlab.com/nx-core/frontend/angular
  ~ @author    Stuart McCulloch Anderson <stuart@nxfifteen.me.uk>
  ~ @copyright Copyright (c) 2020. Stuart McCulloch Anderson <stuart@nxfifteen.me.uk>
  ~ @license   https://nxfifteen.me.uk/api/license/mit/license.html MIT
  -->

<div *ngIf="loading!=loadingExpected">
  <div class="row">
    <div class="col-12">
      LOADING...
      <div class="progress progress-xs mt-2">
        <progressbar class="progress progress-success" [value]="loading" [max]="loadingExpected"
                     type="success"></progressbar>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div id="loader">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="loading"></div>
      </div>
    </div>
  </div>
</div>

<div class="animated fadeIn" *ngIf="loading>=loadingExpected">
  <alert type="md-refresh">
    <div class="row">
      <div class="col-md-6">
        <h3>{{_matomoService.pageTitle}}</h3>
      </div>
      <div class="col-md-6 text-right">
        <button type="button" class="btn btn-brand btn-sm btn-warning mr-1" style="margin-bottom: 4px"
                (click)="pullToRefresh()">
          <i class="fa fa-repeat"></i>
          <span>Refresh</span>
        </button>
      </div>
    </div>
  </alert>

  <div class="row">

    <div class="col-12 col-md-5">
      <div class="row">
        <div class="col-12">
          <div class="card" tooltip="You need {{levelNext}} more XP to reach the next level"
               placement="top"
               triggers="mouseenter:click">
            <div class="card-body">
              <div class="row">
                <div class="col-12 col-md-5 col-lg-2 text-right d-none d-md-block d-lg-block d-xl-block">
                  <img src="{{currentUser.avatar}}" class="img-avatar"
                       width="81px" height="81px"/>
                </div>
                <div class="col-12 col-md-7 col-lg-5 text-center">
                  <div class="row">
                    <div class="col-12 text-right">
                      {{xp}} XP
                      /
                      {{xpNext}} XP
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-12 text-center">
                      <div class="progress mt-2">
                        <progressbar class="progress progress-success"
                                     [value]="levelPercentage" [max]="100"
                                     type="success"></progressbar>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-5 d-none d-lg-block d-xl-block text-right">
                  <img height="81px" src="{{assets_xp_levels}}/{{level}}.png" width="220px"/>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              XP Log
            </div>
            <div class="card-body">
              <div class="row" *ngFor="let logXp of xpLog">
                <div class="col-12 col-lg-2">
                  {{logXp.datetime}}
                </div>
                <div class="col-12 col-lg-10">
                  {{logXp.log}}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-md-7">
      <div class="row">
        <div *ngFor="let awardsSummary of awardsSummaries; let i = index" class="col-12 col-md-6 col-lg-3"
             (click)="awardClicked(awardsSummary.id)">
          <div class="card">
            <div class="card-body">
              <div class="h1 text-muted text-right mb-4" style="font-size: 100%;">
                {{awardsSummary.count}} WINS
                <img class="img-avatar" src="{{assets_badges}}/{{awardsSummary.image}}.png"
                     alt="{{awardsSummary.name}}"
                     width="35px" height="35px"/>
              </div>
              <small class="text-muted text-uppercase font-weight-bold">{{ awardsSummary.name }}</small>
            </div>
          </div>
        </div><!--/.col-->
      </div><!--/.row-->
    </div>
  </div>

</div>
